<!DOCTYPE html>
<html lang="en">
{% include head.html %}
<body>

  <!-- Konten AJAX -->
  <div id="page_holder"></div>

  <footer class="site-footer">
    <p>&copy; 2025 Apip. All rights reserved.</p>
    <nav>
      <a href="{{ '/' | relative_url }}">Home</a> |
      <a href="{{ '/blog/' | relative_url }}">Blog</a> |
      <a href="{{ '/about/' | relative_url }}">About</a>
    </nav>
  </footer>

  <script>
  const pageHolder = document.getElementById('page_holder');
  const base = "{{ site.baseurl }}"; // "/mouse"

  // Fungsi load halaman via fetch
  function loadPage(url) {
    fetch(url)
      .then(res => {
        if (!res.ok) throw new Error('Page not found');
        return res.text();
      })
      .then(html => {
        pageHolder.style.opacity = 0;
        pageHolder.innerHTML = html;
        let op = 0;
        const fadeIn = setInterval(() => {
          op += 0.1;
          pageHolder.style.opacity = op;
          if(op >= 1) clearInterval(fadeIn);
        }, 30);
        window.scrollTo(0,0);
      })
      .catch(err => {
        pageHolder.innerHTML = '<p>Page not found.</p>';
        console.error(err);
      });
  }

  // Pasang listener ke semua link internal
  function attachLinkListeners() {
    document.querySelectorAll('a[href^="/"]').forEach(a => {
      if (a.href.includes(window.location.origin)) {
        a.addEventListener('click', e => {
          e.preventDefault();
          let url = a.getAttribute('href');

          // Tambahkan index.html jika link berakhiran /
          if (url.endsWith('/')) url += 'index.html';

          // Hitung hash bersih tanpa baseurl
          let hash = url.replace(base, '');
          hash = hash.replace(/^\/|\/index\.html$/g,'') || 'home';
          window.location.hash = hash;

          // Load halaman dengan baseurl
          const fetchUrl = base + '/' + (hash === 'home' ? 'index.html' : hash + '/index.html');
          loadPage(fetchUrl);
        });
      }
    });
  }

  // Load halaman awal sesuai hash
  function initPage() {
    let hash = window.location.hash.slice(1) || 'home';
    let fetchUrl = base + '/' + (hash === 'home' ? 'index.html' : hash + '/index.html');
    loadPage(fetchUrl);

    // Pasang listener link setelah konten load
    setTimeout(attachLinkListeners, 100);
  }

  window.addEventListener('hashchange', initPage);
  window.addEventListener('DOMContentLoaded', initPage);
  </script>

<footer class="site-footer">
  <p>&copy; 2025 Apip. All rights reserved.</p>
  <nav>
    <a href="{{ '/' | relative_url }}">Home</a> |
    <a href="{{ '/blog/' | relative_url }}">Blog</a> |
    <a href="{{ '/about/' | relative_url }}">About</a>
  </nav>
</footer>

  </body>
</html>
