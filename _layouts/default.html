<!DOCTYPE html>
<html lang="en">
  {% include head.html %}
  <body>

<div id="page_holder"></div>

<script>
const base = "{{ site.baseurl }}"; // "/mouse"
const pageHolder = document.getElementById('page_holder');

function loadPage(url) {
  fetch(url)
    .then(res => { if (!res.ok) throw new Error('Page not found'); return res.text(); })
    .then(html => {
      pageHolder.style.opacity = 0;
      pageHolder.innerHTML = html;
      let op = 0;
      const fadeIn = setInterval(() => { op += 0.1; pageHolder.style.opacity = op; if(op>=1) clearInterval(fadeIn); }, 30);
      window.scrollTo(0,0);
    })
    .catch(err => { pageHolder.innerHTML = '<p>Page not found.</p>'; console.error(err); });
}

function attachLinkListeners() {
  document.querySelectorAll('a[href^="/"]').forEach(a => {
    if(a.href.includes(window.location.origin)){
      a.addEventListener('click', e=>{
        e.preventDefault();
        let url = a.getAttribute('href');
        if(url.endsWith('/')) url += 'index.html';
        window.location.hash = url.replace(/^\/|\/index\.html$/g,'') || 'home';
        loadPage(base + url);
      });
    }
  });
}

function initPage(){
  let hash = window.location.hash.slice(1) || 'home';
  let url = base + '/' + (hash==='home'?'index.html':hash+'/index.html');
  loadPage(url);
  setTimeout(attachLinkListeners, 100);
}

window.addEventListener('hashchange', initPage);
window.addEventListener('DOMContentLoaded', initPage);
</script>

<footer class="site-footer">
  <p>&copy; 2025 Apip. All rights reserved.</p>
  <nav>
    <a href="{{ '/' | relative_url }}">Home</a> |
    <a href="{{ '/blog/' | relative_url }}">Blog</a> |
    <a href="{{ '/about/' | relative_url }}">About</a>
  </nav>
</footer>

  </body>
</html>
